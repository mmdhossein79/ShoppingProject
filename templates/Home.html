{% extends 'base.html' %}
{% load static %}
{% block content %}
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>

    <script>
    function get_product(url){
                $.ajax({
            method: 'GET',
            url: url,
            success: function (data) {
                console.log('success');
                console.log(data)
                for (const obj of data.results) {
                        let product_name = obj.title;
                        let category = obj.category;
                        let initial_price = obj.marked_price;
                        let final_price = obj.selling_price;
                        let url = `{% url 'product:productdetail' 'none'%}`
                        url = url.replace("none",obj.slug)
                        const card =
                            `<div class="col-md-3 card">
                                    <div class="m-4">
                                        <h4><a href=${url}> ${obj.title}</a></h4>
                                        <img src=${obj.image} alt="" class="img-fluid" style="height: 200px; object-fit: contain;">
                                         <p class="mt-3">Price: <strike>Rs. ${obj.marked_price}</strike> Rs. ${obj.selling_price}</p>
                                       <a href=${url} class="btn btn-primary">Add To Cart</a>
                                    </div>
                            </div>`;
                        $('.product-container').html(card)

                    if (data.next){

                        let next_page = $('<button/>',{
                            text : 'next_page',
                            click : function (){
                                get_product(data.next)
                            }
                        })

                        $('.product-container').append(next_page)

                    }

                    if (data.previous){

                        let previous_page = $('<button/>',{
                            text : 'previous_page',
                            click : function (){
                                get_product(data.previous)
                            }
                        })

                        $('.product-container').append(previous_page)

                    }
                    }


            },
            error: function () {
                console.log('error');
            }
        })


    }
get_product('http://127.0.0.1:8000/api-auth/product/')
    </script>

    <div class="container-fluid">
        <hr>
        <div class="row mt-3 product-container" id="product-container">

        </div>
    </div>


    {#    {% block js %}#}
    {#        <script src="{% static 'customer/js/home.js' %}"></script>#}
    {#    {% endblock %}#}
{% endblock %}

